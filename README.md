# STM32F407VG Motor Control Board Firmware

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–æ—à–∏–≤–∫—É –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ STM32F407VG, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—É—é –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ 10 —à–∞–≥–æ–≤—ã–º–∏ –¥–≤–∏–≥–∞—Ç–µ–ª—è–º–∏ –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–∞—Ö. –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ USART –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞–≤–∞—Ä–∏–π–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –û–±—â–∞—è —Å—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    USB/RS232    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    USART1    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     PC      ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   FTDI      ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   STM32F407VG ‚îÇ
‚îÇ   (Client)  ‚îÇ                ‚îÇ   FT232RL   ‚îÇ             ‚îÇ   (MCU)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                                    ‚îÇ
                                                                    ‚îÇ USART2
                                                                    ‚ñº
                                                           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                                           ‚îÇ   Motor     ‚îÇ
                                                           ‚îÇ  Drivers    ‚îÇ
                                                           ‚îÇ  (1-10)     ‚îÇ
                                                           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **PC (Client)** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—Ç–æ—Ä–∞–º–∏
2. **FTDI FT232RL** - –º–æ—Å—Ç USB ‚Üî USART –¥–ª—è —Å–≤—è–∑–∏ —Å –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º
3. **STM32F407VG** - –æ—Å–Ω–æ–≤–Ω–æ–π –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
4. **Motor Drivers** - –¥—Ä–∞–π–≤–µ—Ä—ã —à–∞–≥–æ–≤—ã—Ö –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π (–¥–æ 10 —à—Ç—É–∫)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ STM32F407VG

- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä**: ARM Cortex-M4 —Å FPU
- **–¢–∞–∫—Ç–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞**: 168 MHz
- **Flash –ø–∞–º—è—Ç—å**: 1 MB
- **SRAM**: 192 KB + 64 KB CCM
- **GPIO –ø–æ—Ä—Ç—ã**: A, B, C, D, E (–¥–æ 114 –ø–∏–Ω–æ–≤)
- **USART**: 6 –∫–∞–Ω–∞–ª–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è USART1, USART2)
- **DMA**: 2 –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞, 16 –ø–æ—Ç–æ–∫–æ–≤
- **–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è**: EXTI, NVIC

## üì° –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏

### –§–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥ (1 –±–∞–π—Ç)

| –ë–∏—Ç—ã | –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|---------|----------|
| `0b1000NNNN` | –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ | –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –®–î –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, N = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ—Ç–æ—Ä–æ–≤ (1-10) |
| `0b0100NNNN` | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ | –ó–∞–ø—É—Å–∫ –ø–æ –º–µ—Ä–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏, N = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ—Ç–æ—Ä–æ–≤ (1-10) |
| `0b00100000` | –ó–∞–ø—Ä–æ—Å –≤–µ—Ä—Å–∏–∏ | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—à–∏–≤–∫–µ |

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

- `0x81` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ 1 –º–æ—Ç–æ—Ä–∞
- `0x82` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ 2 –º–æ—Ç–æ—Ä–æ–≤
- `0x8A` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ 10 –º–æ—Ç–æ—Ä–æ–≤
- `0x41` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ 1 –º–æ—Ç–æ—Ä–∞
- `0x42` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ 2 –º–æ—Ç–æ—Ä–æ–≤
- `0x4A` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ 10 –º–æ—Ç–æ—Ä–æ–≤
- `0x20` - –∑–∞–ø—Ä–æ—Å –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—à–∏–≤–∫–∏

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã

1. **PC ‚Üí MCU**: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã (1 –±–∞–π—Ç)
2. **MCU ‚Üí PC**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (`0x00` –∏–ª–∏ –∫–æ–¥ –æ—à–∏–±–∫–∏)
3. **PC ‚Üí MCU**: –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ—Ç–æ—Ä–æ–≤ (N √ó 16 –±–∞–π—Ç)
4. **MCU**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
5. **MCU ‚Üí PC**: –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (`0xFF` - —É—Å–ø–µ—Ö, –∫–æ–¥ –æ—à–∏–±–∫–∏ - –Ω–µ—É–¥–∞—á–∞)

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –º–æ—Ç–æ—Ä–æ–≤ (16 –±–∞–π—Ç –Ω–∞ –º–æ—Ç–æ—Ä)

```
–ë–∞–π—Ç—ã 0-3:   number (uint32_t)     - –Ω–æ–º–µ—Ä –º–æ—Ç–æ—Ä–∞ (1-10)
–ë–∞–π—Ç—ã 4-7:   acceleration (uint32_t) - —É—Å–∫–æ—Ä–µ–Ω–∏–µ
–ë–∞–π—Ç—ã 8-11:  maxSpeed (uint32_t)   - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
–ë–∞–π—Ç—ã 12-15: steps (uint32_t)      - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤
```

## üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏

### GPIO –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

#### GPIOA - USART –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **PA2** - USART2_TX (—Å–≤—è–∑—å —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ –º–æ—Ç–æ—Ä–æ–≤)
- **PA3** - USART2_RX (—Å–≤—è–∑—å —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ –º–æ—Ç–æ—Ä–æ–≤)
- **PA9** - USART1_TX (—Å–≤—è–∑—å —Å –ü–ö)
- **PA10** - USART1_RX (—Å–≤—è–∑—å —Å –ü–ö)

#### GPIOB - –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **PB0-PB9** - KEY1-10 (–≤—Ö–æ–¥—ã —Å –ø–æ–¥—Ç—è–∂–∫–æ–π –≤–≤–µ—Ä—Ö)

#### GPIOC - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏
- **PC0-PC9** - EN1-10 (–≤—ã—Ö–æ–¥—ã –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è –¥—Ä–∞–π–≤–µ—Ä–æ–≤)

#### GPIOD - –í—ã–±–æ—Ä –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- **PD0-PD9** - SELECT1-10 (–≤—ã—Ö–æ–¥—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞)
- **PD14** - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω—ã–π —Å–≤–µ—Ç–æ–¥–∏–æ–¥

#### GPIOE - –°—Ç–∞—Ç—É—Å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **PE0-PE9** - STATUS1-10 (–≤—Ö–æ–¥—ã —Å—Ç–∞—Ç—É—Å–∞ –º–æ—Ç–æ—Ä–æ–≤, –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è)
- **PE10-PE15** - ENDSTOP1-6 (–∫–æ–Ω—Ü–µ–≤—ã–µ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–∏, –∞–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)

### DMA –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- **DMA1_Stream6** - USART2_TX (–ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–∞–º)
- **DMA2_Stream7** - USART1_TX (–ø–µ—Ä–µ–¥–∞—á–∞ –æ—Ç–≤–µ—Ç–æ–≤ –ü–ö)
- **DMA2_Stream5** - USART1_RX (–ø—Ä–∏–µ–º –∫–æ–º–∞–Ω–¥ –æ—Ç –ü–ö)

## ‚öôÔ∏è –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (0x8N)

1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–æ—Ç–æ—Ä–æ–≤
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤ –ø–æ –æ—á–µ—Ä–µ–¥–∏:
   - –í—ã–±–æ—Ä –¥—Ä–∞–π–≤–µ—Ä–∞ (SELECT)
   - –í–∫–ª—é—á–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞ (EN)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ USART2
   - –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (STATUS)
   - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞
3. –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ GPIO
4. –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤
5. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (0x4N)

1. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–æ—Ç–æ—Ä–æ–≤
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ—Ç–æ—Ä–∞:
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞
   - –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫
3. –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤
4. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

## üö® –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞

- **–¢—Ä–∏–≥–≥–µ—Ä**: –õ—é–±–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ ENDSTOP (PE10-PE15)
- **–î–µ–π—Å—Ç–≤–∏–µ**: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö EN (PC0-PC9)
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –í—ã—Å—à–∏–π (NVIC priority 0)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –æ—à–∏–±–∫–∏ `0x0B`

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è

- **STATUS –ø–∏–Ω—ã** (PE0-PE9) –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –º–æ—Ç–æ—Ä–æ–≤
- **–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è** –ø–æ —Ñ—Ä–æ–Ω—Ç—É —Å–∏–≥–Ω–∞–ª–∞ STATUS
- **–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥** –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
STM32F407VG_MOTOR_BOARD_CPP/
‚îú‚îÄ‚îÄ source/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ—à–∏–≤–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp              # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ motor_controller.cpp  # –õ–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—Ç–æ—Ä–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ motor_controller.hpp  # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ motor_settings.cpp    # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ MotorSettings
‚îÇ   ‚îú‚îÄ‚îÄ motor_settings.hpp    # –ö–ª–∞—Å—Å –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ—Ç–æ—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ constants.hpp         # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ CMakeLists.txt        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ system/                    # –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã CMSIS
‚îÇ   ‚îú‚îÄ‚îÄ include/              # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã STM32F407VG
‚îÇ   ‚îî‚îÄ‚îÄ source/               # –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏
‚îú‚îÄ‚îÄ docs/                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ MotorManagerServicer_device_interface.md  # –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏
‚îÇ   ‚îú‚îÄ‚îÄ scheme.pdf            # –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ DS_STM32F407VG.pdf    # Datasheet –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ RM_STM32F407VG.pdf    # Reference Manual
‚îú‚îÄ‚îÄ ldscripts/                 # –°–∫—Ä–∏–ø—Ç—ã –ª–∏–Ω–∫–æ–≤—â–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ flash.ld              # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
‚îú‚îÄ‚îÄ CMakeLists.txt            # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CMake
‚îî‚îÄ‚îÄ README.md                 # –î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
```

## üöÄ –°–±–æ—Ä–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **ARM GCC**: arm-none-eabi-gcc, arm-none-eabi-g++
- **CMake**: –≤–µ—Ä—Å–∏—è 3.16 –∏–ª–∏ –≤—ã—à–µ
- **–°–∏—Å—Ç–µ–º–∞**: macOS, Linux, Windows

### –°–±–æ—Ä–∫–∞

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–±–æ—Ä–∫–∏
mkdir build && cd build

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
cmake ..

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏
make

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–±–æ—Ä–∫–∏
# - main.elf - –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
# - main.hex - HEX —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
# - main.bin - –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª
# - main.map - –∫–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏
```

### –†–∞–∑–º–µ—Ä –ø—Ä–æ—à–∏–≤–∫–∏

- **–ö–æ–¥**: 1728 –±–∞–π—Ç
- **–î–∞–Ω–Ω—ã–µ**: 52 –±–∞–π—Ç–∞
- **BSS**: 264 –±–∞–π—Ç–∞
- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä**: 2044 –±–∞–π—Ç–∞

## üîç –û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

- **PD14** - —Å–≤–µ—Ç–æ–¥–∏–æ–¥ (–≤–∫–ª—é—á–µ–Ω = —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- **USART1** - –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –∫–æ–º–∞–Ω–¥—ã
- **STATUS –ø–∏–Ω—ã** - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ—Ç–æ—Ä–æ–≤
- **ENDSTOP –ø–∏–Ω—ã** - –∞–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `0x00` | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–∏–µ–º—É |
| `0x01` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ—Ç–æ—Ä–æ–≤ |
| `0x02` | –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã |
| `0x0B` | –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ |
| `0xFF` | –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [STM32F407VG Datasheet](docs/DS_STM32F407VG.pdf)
- [STM32F407VG Reference Manual](docs/RM_STM32F407VG.pdf)
- [–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏](docs/MotorManagerServicer_device_interface.md)
- [–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è](docs/scheme.pdf)

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [ARM GCC Toolchain](https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain)
- [CMSIS Documentation](https://arm-software.github.io/CMSIS_5/)

